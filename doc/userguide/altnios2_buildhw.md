How to generate the bitstream {#page_altbuildhw}
============

[TOC]

The Quartus projects for the FPGA configuration are located in the folder
`src/fpga/altera/boards/[board_name]/[example_name]`. In order to generate a
bitstream for the FPGA of the POWERLINK processor a few steps need to be
executed. After a successful generation the project directory consists of a
file called `[toplevel].sof` (The bitstream to download) and a file called
`[qsys_system].sopcinfo` (The information about the layout of the embedded
system). These two files can be generated by using the approaches explained in
the next sections.

# The Quartus II IDE    {#sect_buildhw_quartus}
If you want to generate the bitstream manually a few steps need to be carried
out in the Quartus II IDE.

1. Open the toolchain **Quartus II 13.0sp1**. (**Note:** It is important to use
   exactly this version of the toolchain)
2. Open a desired project from `fpga/boards/[platform]/[board_name]/[example_name]`
   by clicking on `File -> Open Project`.
3. Open the tool Qsys with `Tools -> Qsys` and open the file `[toplevel].qsys`.
4. In Qsys select the tab **Generation** and click on the **Generate** button.
    - In Qsys the whole embedded system of the POWERLINK processor is described
      and also the IP-Cores from \ref page_idxipcore are instantiated. The ipcore
      \ref page_plkif provides the option to switch from one demo (cn-gpio, sn-gpio,
      etc...) to the other.
    - In addition also the openMAC core can be reconfigured by the user.
5. After the Qsys generation is finished the file `[qsys_system].sopcinfo` is
   generated in the project folder.
6. In order to generate the bitstream `[toplevel].sof` switch back to Quartus II
   and click on `Processing -> Start Compilation`.

> **Note:** The Quartus II synthesis can take several minutes.

# The script create-this-fpga   {#sect_buildhw_script}
The bitstream can be generated automatically by using the script called **create-this-fpga**
located in the folder `src/misc/altera_nios2/scripts`.

In order to execute this script open the `Nios II 13.0sp1 Command Shell` or a
shell where the path to the Quartus II toolchain is set. In this shell execute the
following command:

      > cd src/misc/altera_nios2/scripts
      > ./create-this-fpga ../../../fpga/boards/[platform]/[board_name]/[example_name]
